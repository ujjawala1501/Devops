
### ğŸ’¡ Git Lesson Learned: Resetting Git History the Right Way

Recently, I worked on a task involving Git history cleanup on a remote server for a test repository used by the Nautilus team. The objective was to **reset the commit history** of the repository so that only two specific commits remain:

1. `initial commit`
2. `add data.txt file`

Hereâ€™s how I approached it (and what I learned along the way):

---

### âœ… Step-by-Step Execution

#### 1ï¸âƒ£ SSH into the storage server

```bash
ssh natasha@ststor01.stratos.xfusioncorp.com
```

> I confirmed the authenticity of the host when prompted and logged in successfully.

---

#### 2ï¸âƒ£ Navigated to the repo

```bash
cd /usr/src/kodekloudrepos/demo
```

---

#### 3ï¸âƒ£ Checked Git version (small typo at first)

I initially used:

```bash
git -version
```

ğŸ›‘ **Mistake**: `-version` is incorrect.

âœ… Correct command:

```bash
git --version
```

---

#### 4ï¸âƒ£ Tried running `git blog` (another typo!)

```bash
git blog
```

ğŸ›‘ **Mistake**: There's no `blog` command in Git.

âœ… Correct command was `git log`:

```bash
git log
```

> Shows commit history in detail.

---

#### 5ï¸âƒ£ Saw an error related to "dubious ownership"

```bash
git branch
```

ğŸ›‘ **Error**:

```bash
fatal: detected dubious ownership in repository
```

âœ… Fix:

```bash
git config --global --add safe.directory /usr/src/kodekloudrepos/demo
```

> This marks the repo as safe to use in Git (common in shared environments).

---

#### 6ï¸âƒ£ Verified branches and history

```bash
git branch
git log --oneline
```

> I identified the **commit hashes** I needed:

* `c7f2bed` â†’ "add data.txt file"
* `54760a1` â†’ "initial commit"

---

#### 7ï¸âƒ£ Attempted incorrect `git reset` syntax

ğŸ›‘ I tried this (wrong syntax):

```bash
git reset --soft <c7f2bed>
```

ğŸ§  **Mistake**: I incorrectly used `< >` which is *not* valid in shell. It's just used to indicate placeholders in documentation.

âœ… Correct command:

```bash
git reset --hard c7f2bed
```

> I used `--hard` to reset both HEAD and the working directory to that specific commit. Then I went further back to initial commit too:

```bash
sudo git reset --hard 54760a1
```

Then moved forward again:

```bash
sudo git reset --hard c7f2bed
```

Now the commit history was:

```bash
git log --oneline
```

```
c7f2bed add data.txt file
54760a1 initial commit
```

Exactly what I needed âœ…

---

#### 8ï¸âƒ£ Final step: Force push to remote repo

```bash
sudo git push -f origin master
```

> `-f` (force) is required because the local history has diverged from the remote. This **overwrites** the remote history with your local version â€” so always use with caution.

---

### ğŸ“Œ Key Takeaways

* âš ï¸ Never use `< >` literally in shell commands
* `git reset --hard <commit>` moves both HEAD and the working directory to the desired commit
* Always use `git log --oneline` for a cleaner view when navigating commit histories
* When rewriting Git history, always **double-check commit hashes** before pushing
* You may need to configure a directory as â€œsafeâ€ if you're working in a shared environment

---

### ğŸš€ Outcome

âœ… Repository was successfully cleaned
âœ… Only the two desired commits remained
âœ… Changes were force-pushed to remote
âœ… Learned a LOT about Git internals and handling real-world Git errors

---
ğŸŒŸ Pro Tip

You can also limit or customize what git log shows:
git log --oneline --all
git log --since="2 weeks ago"
git log --author="Admin"

*********************************
ğŸ‘‡ Why git log Showed Only a Few Commits

When you ran:

git log


It probably showed only 5-6 commits because:

Git paginates the output using a built-in pager (usually less)

You were likely still inside the pager, and exited it (by pressing q) before scrolling further

âœ… How to View the Rest of the Commits

When inside git log (in the pager), use these navigation keys:

â†“ or Enter â†’ Scroll down one line

Space â†’ Scroll down one page

b â†’ Scroll up one page

/search-term â†’ Search commits

q â†’ Quit and return to shell
